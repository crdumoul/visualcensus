function drawChartsForWard() {
    <% @pie_tables.each do |table| %>
        var values = new Array();
        <% table.regular_rows.each do |row| %>
            <% column = @ward.column_for(row) %>
            values.push({name: '<%= escape_javascript(row.name) %>', value: <%= column.value %>})
        <% end %>
        drawPie('ward_table_div_<%= table.id %>', values);
    <% end %>

    <% @percent_tables.each do |table| %>
        var values = new Array();
        <% total_column = @ward.column_for(table.total_row) %>
        <% table.regular_rows.each do |row| %>
            <% column = @ward.column_for(row) %>
            values.push({name: '<%= escape_javascript(row.name) %>', value: <%= ((column.value*1.0) / total_column.value) * 100 %>})
        <% end %>
        drawColumn('ward_table_div_<%= table.id %>', '', 'Percent', values);
    <% end %>
}

function doStuff() {
    $("#ward_name").html("<%= @ward.name %>");
    drawChartsForWard();
    $("#ward_name").fadeTo(400, 1);
    $(".ward_table_div").fadeTo(400, 1);
}
setTimeout(doStuff, 10);
